{{ vars.service_config.imports|generate_import }}
{{ link_imports|generate_import }}
{{ vars.record.class|generate_import }}
{{ vars.permissions.class|generate_import }}
{{ vars.marshmallow.class|generate_import }}
# TODO: waiting for search
# {{ vars.search_options.class|generate_import }}


class {{ vars.service_config|class_header }}:
    """{{ vars.record.class|base_name }} service config."""
    PERMISSIONS_PRESETS = [{% for p in vars.permissions.presets %}"{{ p }}"{{ ", " if not loop.last else "" }} {% endfor %}]

    url_prefix = "{{ vars.resource_config.base_url }}"
    base_permission_policy_cls = {{ vars.permissions.class|base_name }}

    schema = {{ vars.marshmallow.class|base_name }}
    # TODO: waiting for search
    # search = {{ vars.search_options.class|base_name }}
    record_cls = {{ vars.record.class|base_name }}
    service_id = "{{ vars.service_config.service_id }}"

    components = [ {% for b in vars.service_config.base_classes %}*{{ b|base_name }}.components{% if not loop.last %}, {% endif %}{% endfor %}{% for c in vars.service_config.components %}, {{ c|base_name }} {% endfor %}]

    model = "{{ vars.module.qualified }}"

    {% if vars.service_config.generate_links %}
    @property
    def links_item(self):
        return {
            {% for link in links.item %}
            {% if link.name -%} "{{link.name}}": {%- else -%}**{%-endif-%}{{link.link_class}}({{link.link_args_str}}),
            {% endfor %}
        }

    @property
    def links_search(self):
        return {
            {% for link in links.search %}
            {% if link.name -%} "{{link.name}}": {%- else -%}**{%-endif-%}{{link.link_class}}({{link.link_args_str}}),
            {% endfor %}
        }
{% endif %}

{{ vars.service_config.extra_code }}