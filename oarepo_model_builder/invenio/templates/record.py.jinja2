from invenio_records.systemfields import ConstantField
from invenio_records_resources.records.systemfields import IndexField

{{ vars.pid|generate_import('provider-class') }}
{{ vars.pid.imports|generate_import }}
{{ vars.record_metadata|generate_import }}
{{ vars.record_dumper|generate_import }}
{{ vars.record.imports|generate_import }}

class {{ vars.record|class_header }}:
    model_cls = {{ vars.record_metadata.class|base_name }}
{% if vars.json_schema_settings.name %}
    schema = ConstantField("$schema", "{{ settings.schema_server }}{{ vars.json_schema_settings.name }}")
{% endif %}
{% if vars.mapping_settings.index %}
    index = IndexField("{{ vars.mapping_settings.index }}")
{% endif %}
{% if not vars.pid.skip %}
    pid = {{ vars.pid.field_class }}(
        provider={{ vars.pid.provider_class|base_name }},
        context_cls={{ vars.pid.context_class }}{% if vars.pid.field_args %},
        {{ vars.pid.field_args|generate_list }}
    {% endif %}
    )
{% endif %}
    dumper_extensions = [ {{ vars.record.dumper_extensions|generate_list }} ]
    dumper = {{ vars.record_dumper.class|base_name }}(extensions=dumper_extensions)

{{ vars.record.extra_code }}